!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).SpriteAnim=t()}}(function(){return function t(e,r,i){function n(o,a){if(!r[o]){if(!e[o]){var h="function"==typeof require&&require;if(!a&&h)return h(o,!0);if(s)return s(o,!0);var u=new Error("Cannot find module '"+o+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[o]={exports:{}};e[o][0].call(c.exports,function(t){var r=e[o][1][t];return n(r||t)},c,c.exports,t,e,r,i)}return r[o].exports}for(var s="function"==typeof require&&require,o=0;o<i.length;o++)n(i[o]);return n}({1:[function(t,e,r){var i,n=e.exports={},s=[],o=!1,a=-1;function h(){o=!1,i.length?s=i.concat(s):a=-1,s.length&&u()}function u(){if(!o){var t=setTimeout(h);o=!0;for(var e=s.length;e;){for(i=s,s=[];++a<e;)i[a].run();a=-1,e=s.length}i=null,o=!1,clearTimeout(t)}}function c(t,e){this.fun=t,this.array=e}function f(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];s.push(new c(t,e)),1!==s.length||o||setTimeout(u,0)},c.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=f,n.addListener=f,n.once=f,n.off=f,n.removeListener=f,n.removeAllListeners=f,n.emit=f,n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}},{}],2:[function(t,e,r){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],3:[function(t,e,r){for(var i=t("performance-now"),n="undefined"==typeof window?{}:window,s=["moz","webkit"],o="AnimationFrame",a=n["request"+o],h=n["cancel"+o]||n["cancelRequest"+o],u=0;u<s.length&&!a;u++)a=n[s[u]+"Request"+o],h=n[s[u]+"Cancel"+o]||n[s[u]+"CancelRequest"+o];if(!a||!h){var c=0,f=0,p=[];a=function(t){if(0===p.length){var e=i(),r=Math.max(0,1e3/60-(e-c));c=r+e,setTimeout(function(){var t=p.slice(0);p.length=0;for(var e=0;e<t.length;e++)if(!t[e].cancelled)try{t[e].callback(c)}catch(t){setTimeout(function(){throw t},0)}},Math.round(r))}return p.push({handle:++f,callback:t,cancelled:!1}),f},h=function(t){for(var e=0;e<p.length;e++)p[e].handle===t&&(p[e].cancelled=!0)}}e.exports=function(t){return a.call(n,t)},e.exports.cancel=function(){h.apply(n,arguments)}},{"performance-now":4}],4:[function(t,e,r){(function(t){(function(){var r,i,n;"undefined"!=typeof performance&&null!==performance&&performance.now?e.exports=function(){return performance.now()}:null!=t&&t.hrtime?(e.exports=function(){return(r()-n)/1e6},i=t.hrtime,n=(r=function(){var t;return 1e9*(t=i())[0]+t[1]})()):Date.now?(e.exports=function(){return Date.now()-n},n=Date.now()):(e.exports=function(){return(new Date).getTime()-n},n=(new Date).getTime())}).call(this)}).call(this,t("_process"))},{_process:1}],5:[function(t,e,r){function i(){}i.prototype={on:function(t,e,r){var i=this.e||(this.e={});return(i[t]||(i[t]=[])).push({fn:e,ctx:r}),this},once:function(t,e,r){var i=this,n=function(){i.off(t,n),e.apply(r,arguments)};return this.on(t,n,r)},emit:function(t){for(var e=[].slice.call(arguments,1),r=((this.e||(this.e={}))[t]||[]).slice(),i=0,n=r.length;i<n;i++)r[i].fn.apply(r[i].ctx,e);return this},off:function(t,e){var r=this.e||(this.e={}),i=r[t],n=[];if(i&&e)for(var s=0,o=i.length;s<o;s++)i[s].fn!==e&&n.push(i[s]);return n.length?r[t]=n:delete r[t],this}},e.exports=i},{}],6:[function(t,e,r){"use strict";var i=t("raf"),n=0,s=function(){this.items=[],this.isRunning=!1,this.tickId=-1,this.tickCb=this.onTick.bind(this)};s.prototype.start=function(){this.isRunning=!0,this.tickId=i(this.tickCb)},s.prototype.pause=function(){this.isRunning=!1,i.cancel(this.tickId)},s.prototype.add=function(t){var e=n++;return this.items.push({id:e,cb:t}),this.isRunning||this.start(),e},s.prototype.remove=function(t){for(var e,r=0,i=this.items.length;r<i;r++)if(this.items[r].id===t){e=this.items.splice(r,1)[0];break}return 0===this.items.length&&this.pause(),e},s.prototype.onTick=function(t){this.tickId=i(this.tickCb);for(var e=0,r=this.items.length;e<r;e++)this.items[e]&&this.items[e].cb(t)},e.exports=s},{raf:3}],7:[function(t,e,r){"use strict";e.exports=function(t,e){var r;e=e||1,this.frames=[],this.numFrames=t.frames.length;for(var i=0;i<this.numFrames;i++)r=t.frames[i].frame,this.frames.push({index:i,x:r.x*e,y:r.y*e,width:r.w*e,height:r.h*e})}},{}],8:[function(t,e,r){"use strict";var i=t("../utils/is-array"),n=function(t,e,r){if(this.frameSize=e,this.options=r||{},this.scaleFactor=this.options.scaleFactor||1,this.numFrames=this.options.numFrames,this.frames=[],i(t))for(var n=0,s=t.length;n<s;n++)this.initSpriteFrames(t[n],n);else this.initSpriteFrames(t,0);this.numFrames||(this.numFrames=this.frames.length)};n.prototype.initSpriteFrames=function(t,e){var r=t.naturalWidth||t.width,i=t.naturalHeight||t.height,n=t.offsetX||0,s=t.offsetY||0;r*=this.scaleFactor,i*=this.scaleFactor;var o=Math.ceil(r/this.frameSize.width),a=Math.ceil(i/this.frameSize.height);t:for(var h=0;h<a;h++)for(var u=0;u<o;u++)if(this.frames.push({x:u*this.frameSize.width+n,y:h*this.frameSize.height+s,index:this.frames.length,width:this.frameSize.width,height:this.frameSize.height,spriteIndex:e}),this.frames.length===this.numFrames)break t},e.exports=n},{"../utils/is-array":13}],9:[function(t,e,r){"use strict";var i=t("../utils/default-values"),n=t("../utils/is-array"),s=function(t,e,r){i(this,{clearFrame:!0},r=r||{}),this.canvas=t,n(e)?this.sprites=e:this.sprites=[e],this.sprite=e,this.context=t.getContext("2d")};s.prototype.render=function(t,e){this.clearFrame&&this.context.clearRect(0,0,t.width,t.height),this.context.globalAlpha=e.alpha,this.context.drawImage(this.sprites[t.spriteIndex],t.x,t.y,t.width,t.height,e.x,e.y,t.width,t.height)},e.exports=s},{"../utils/default-values":12,"../utils/is-array":13}],10:[function(t,e,r){"use strict";var i=t("../utils/is-array"),n=function(t,e){e=e||{},this.element=t,this.scaleFactor=e.scaleFactor||1,this.sprite=e.sprite,this.spriteIndex=0,this.sprite&&this.updateSprite()};n.prototype.updateSprite=function(){var t,e=(t=i(this.sprite)?this.sprite[this.spriteIndex]:this.sprite).naturalWidth*this.scaleFactor,r=t.naturalHeight*this.scaleFactor;this.element.style.backgroundImage="url("+t.src+")",this.element.style.backgroundSize=e+"px "+r+"px"},n.prototype.render=function(t){t.spriteIndex!==this.spriteIndex&&(this.spriteIndex=t.spriteIndex,this.updateSprite()),this.element.style.backgroundPosition="-"+t.x*this.scaleFactor+"px -"+t.y*this.scaleFactor+"px"},e.exports=n},{"../utils/is-array":13}],11:[function(t,e,r){"use strict";var i=t("../utils/default-values"),n=function(t,e,r){r=r||{},this.canvas=t,this.sprite=e;i(this,{clearFrame:!0},r),this.buffer=document.createElement("canvas"),this.buffer.width=e.width,this.buffer.height=e.height,this.bufferContext=this.buffer.getContext("2d"),this.bufferContext.drawImage(e,0,0),this.context=t.getContext("2d")};n.prototype.render=function(t,e){this.clearFrame&&this.context.clearRect(0,0,t.width,t.height),this.context.globalAlpha=e.alpha,this.context.putImageData(this.bufferContext.getImageData(t.x,t.y,t.width,t.height),e.x,e.y,0,0,t.width,t.height)},e.exports=n},{"../utils/default-values":12}],12:[function(t,e,r){e.exports=function(t,e,r){for(var i in e)t[i]=void 0!==r[i]?r[i]:e[i]}},{}],13:[function(t,e,r){e.exports=function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],14:[function(t,e,r){"use strict";var i=t("./utils/default-values"),n=t("tiny-emitter"),s=t("inherits"),o=new(t("./Ticker")),a=function(t,e,r){r=r||{},this.parser=t,this.renderer=e;var n={manualUpdate:!1,frameRate:60,loop:!1,yoyo:!1,numFrames:t.numFrames};return i(this,n,r),this.lastFrame=this.numFrames-1,this.enterFrameId=-1,this.enterFrameCb=this.onEnterFrame.bind(this),this.currentFrame=0,this.isPlaying=!1,this.reversed=!1,this.complete=!1,this.lastFrameTime=0,this.interval=1e3/this.frameRate,this.x=0,this.y=0,this.alpha=1,this};s(a,n),a.prototype.play=function(){return this.isPlaying=!0,this.complete=!1,this.manualUpdate||(this.enterFrameId=o.add(this.enterFrameCb)),this},a.prototype.pause=function(){return this.isPlaying=!1,this.manualUpdate||o.remove(this.enterFrameId),this},a.prototype.stop=function(){return this.pause(),this.currentFrame=0,this},a.prototype.gotoAndPlay=function(t){return this.currentFrame=t,this.complete=!1,this.isPlaying||this.play(),this},a.prototype.gotoAndStop=function(t){return this.isPlaying&&this.pause(),this.currentFrame=t,this.renderFrame(),this},a.prototype.nextFrame=function(){return this.currentFrame++,this.currentFrame>this.lastFrame&&(this.currentFrame=this.lastFrame),this.currentFrame>=this.lastFrame&&(this.complete=!0),this},a.prototype.prevFrame=function(){return this.currentFrame--,this.currentFrame<0&&(this.currentFrame=0),this.currentFrame<=0&&(this.complete=!0),this},a.prototype.renderFrame=function(){return this.renderer.render(this.parser.frames[this.currentFrame],this),this},a.prototype.dispose=function(){return this.stop(),this.off("complete").off("enterFrame"),this},a.prototype.onComplete=function(){return this.loop?(this.yoyo&&(this.reversed=!this.reversed),this.reversed?this.gotoAndPlay(this.lastFrame):this.gotoAndPlay(0)):this.pause(),this.emit("complete"),this},a.prototype.onEnterFrame=function(t){if(t-this.lastFrameTime>this.interval||0===this.lastFrameTime){if(this.lastFrameTime=t,this.manualUpdate||this.renderFrame(),this.complete)return void this.onComplete();this.isPlaying&&(this.reversed?this.prevFrame():this.nextFrame()),this.emit("enterFrame")}return this},e.exports=a,e.exports.CanvasRenderer=t("./renderer/CanvasRenderer.js"),e.exports.OffScreenCanvasRenderer=t("./renderer/OffScreenCanvasRenderer.js"),e.exports.DOMRenderer=t("./renderer/DOMRenderer.js"),e.exports.SimpleParser=t("./parser/SimpleParser.js"),e.exports.JSONArrayParser=t("./parser/JSONArrayParser.js")},{"./Ticker":6,"./parser/JSONArrayParser.js":7,"./parser/SimpleParser.js":8,"./renderer/CanvasRenderer.js":9,"./renderer/DOMRenderer.js":10,"./renderer/OffScreenCanvasRenderer.js":11,"./utils/default-values":12,inherits:2,"tiny-emitter":5}]},{},[14])(14)});